import{d as k}from"./utils-1a885c55.js";import{d as K,r as j,k as w,c as f,l as h,w as $,a as c,o as p,b as g,i as r,f as i,F as P,j as R,n as S,p as q,q as E,e as F,m as v,s as I,h as L}from"./index-9844670a.js";import{_ as z}from"./_plugin-vue_export-helper-c27b6911.js";const G={class:"a-form-table w-100-p"},H={class:"mt20"},J=K({name:"AFormTable"}),M=K({...J,props:{modelValue:{default:()=>[]},columns:{default:()=>[]},rowKey:{default:"id"},disabled:{type:Boolean,default:void 0}},emits:["update:modelValue"],setup(A,{emit:B}){const s=A,_=j(),n=w(q,void 0),t=w(E,void 0),m=f(()=>s.disabled||(n==null?void 0:n.disabled)),o=f({get:()=>{var e;return{list:(e=s.modelValue)==null?void 0:e.map(l=>(l[s.rowKey]=l[s.rowKey]??h(),l))}},set:e=>{B("update:modelValue",e.list)}}),C=f(()=>{const e={};for(const l of s.columns)e[l.prop]=l.defaultValue??"";return e}),b=e=>{var l;(l=_.value)==null||l.validate(d=>{d&&e==="current"&&(t==null?void 0:t.validateState)==="error"&&(n==null||n.validateField([t==null?void 0:t.prop]))})},N=e=>{const l=k(o.value);l.list.splice(e,1),o.value=l},x=()=>{var e;(e=_.value)==null||e.validate(l=>{if(l){const d=k(o.value);d.list.push({...C.value,[s.rowKey]:h()}),o.value=d}})};return $(()=>t==null?void 0:t.validateState,()=>{b("parent")},{immediate:!0,deep:!0}),$(()=>o.value.list,()=>{b("current")},{deep:!0}),(e,l)=>{const d=c("el-form-item"),y=c("el-table-column"),V=c("el-button"),D=c("el-table"),U=c("el-form");return p(),g("div",G,[r(U,{ref_key:"ATableFormRef",ref:_,model:o.value,disabled:m.value},{default:i(()=>[r(D,{data:o.value.list,"row-key":e.rowKey},{default:i(()=>[(p(!0),g(P,null,R(e.columns,a=>(p(),F(y,v({key:a.prop},a.columnsAttrs),{default:i(u=>[r(d,v(a.formItemAttrs,{prop:`list.${u.$index}.${a.prop}`}),{default:i(()=>[a.attrs?(p(),F(I(a.attrs.typeName),v({key:0,label:`list.${u.$index}.${a.prop}`},a.attrs[a.attrs.typeName],{modelValue:o.value.list[u.$index][a.prop],"onUpdate:modelValue":T=>o.value.list[u.$index][a.prop]=T}),null,16,["label","modelValue","onUpdate:modelValue"])):L("",!0)]),_:2},1040,["prop"])]),_:2},1040))),128)),r(y,{align:"center",width:"150"},{default:i(a=>[r(V,{type:"danger",circle:"",icon:"Delete",disabled:m.value,onClick:u=>N(a.$index)},null,8,["disabled","onClick"])]),_:1})]),_:1},8,["data","row-key"])]),_:1},8,["model","disabled"]),S("div",H,[r(V,{type:"primary",icon:"Plus",circle:"",disabled:m.value,onClick:x},null,8,["disabled"])])])}}});const X=z(M,[["__scopeId","data-v-6306f611"]]);export{X as default};
