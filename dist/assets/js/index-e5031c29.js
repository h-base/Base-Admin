import{d as S,X as R,k as w,c as q,r as g,w as K,a as u,o as y,b as V,i as o,f as p,n as i,h as k,Y as L,y as C,O as M,e as Z,U as m,V as A,W as H,p as O,q as W}from"./index-9844670a.js";import{u as X}from"./index-07c7c589.js";import{_ as Y}from"./_plugin-vue_export-helper-c27b6911.js";const I=r=>(A("data-v-a638ea42"),r=r(),H(),r),G={class:"upload-box"},J={class:"upload-empty"},Q=["src"],ee=["onClick"],ae=I(()=>i("span",null,"查看",-1)),le=["onClick"],te=I(()=>i("span",null,"删除",-1)),se={class:"el-upload__tip"},oe=S({name:"AUploadImgs"}),ie=S({...oe,props:{modelValue:{default:()=>[]},api:{type:Function,default:void 0},drag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},limit:{default:5},fileSize:{default:5},fileType:{default:()=>["image/jpeg","image/png","image/gif"]},height:{default:"150px"},width:{default:"150px"},borderRadius:{default:"8px"}},emits:["update:modelValue"],setup(r,{emit:h}){const l=r;R(e=>({"5b296b08":e.borderRadius,"689819dc":e.width,dec7b05e:e.height}));const n=w(O,void 0),_=w(W,void 0),f=q(()=>l.disabled||(n==null?void 0:n.disabled)),s=g(l.modelValue);K(()=>l.modelValue,e=>{s.value=e});const $=e=>{const a=e.size/1024/1024<l.fileSize,t=l.fileType.includes(e.type);return t||m({title:"温馨提示",message:"上传图片不符合所需的格式！",type:"warning"}),a||setTimeout(()=>{m({title:"温馨提示",message:`上传图片大小不能超过 ${l.fileSize}M！`,type:"warning"})},0),t&&a},z=async e=>{let a=new FormData;a.append("file",e.file);try{const t=l.api??X,{data:c}=await t(a);e.onSuccess(c)}catch(t){e.onError(t)}},B=(e,a)=>{e&&(a.url=e.url,h("update:modelValue",s.value),_!=null&&_.prop&&(n==null||n.validateField([_.prop])),m({title:"温馨提示",message:"图片上传成功！",type:"success"}))},U=e=>{s.value=s.value.filter(a=>a.url!==e.url||a.name!==e.name),h("update:modelValue",s.value)},E=()=>{m({title:"温馨提示",message:"图片上传失败，请您重新上传！",type:"error"})},T=()=>{m({title:"温馨提示",message:`当前最多只能上传 ${l.limit} 张图片，请移除后上传！`,type:"warning"})},b=g(""),v=g(!1),D=e=>{b.value=(e==null?void 0:e.url)??"",v.value=!0};return(e,a)=>{const t=u("Plus"),c=u("el-icon"),N=u("ZoomIn"),P=u("Delete"),j=u("el-upload"),x=u("el-image-viewer");return y(),V("div",G,[o(j,{"file-list":s.value,"onUpdate:fileList":a[1]||(a[1]=d=>s.value=d),action:"#","list-type":"picture-card",class:M(["upload",f.value?"disabled":"",e.drag?"no-border":""]),multiple:!0,disabled:f.value,limit:e.limit,"http-request":z,"before-upload":$,"on-exceed":T,"on-success":B,"on-error":E,drag:e.drag,accept:e.fileType.join(",")},{file:p(({file:d})=>[i("img",{src:d.url,class:"upload-image"},null,8,Q),i("div",{class:"upload-handle",onClick:a[0]||(a[0]=L(()=>{},["stop"]))},[i("div",{class:"handle-icon",onClick:F=>D(d)},[o(c,null,{default:p(()=>[o(N)]),_:1}),ae],8,ee),f.value?k("",!0):(y(),V("div",{key:0,class:"handle-icon",onClick:F=>U(d)},[o(c,null,{default:p(()=>[o(P)]),_:1}),te],8,le))])]),default:p(()=>[i("div",J,[C(e.$slots,"empty",{},()=>[o(c,null,{default:p(()=>[o(t)]),_:1})],!0)])]),_:3},8,["file-list","class","disabled","limit","drag","accept"]),i("div",se,[C(e.$slots,"tip",{},void 0,!0)]),v.value?(y(),Z(x,{key:0,"url-list":[b.value],onClose:a[2]||(a[2]=d=>v.value=!1)},null,8,["url-list"])):k("",!0)])}}});const re=Y(ie,[["__scopeId","data-v-a638ea42"]]);export{re as default};
