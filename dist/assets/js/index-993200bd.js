import{d as I,X as q,r as k,l as M,k as V,c as K,a as l,o as i,b as c,i as o,f as r,F as P,n as t,h as v,Y as R,y as w,O as Z,e as A,U as f,V as H,W as O,p as W,q as X}from"./index-9844670a.js";import{u as Y}from"./index-07c7c589.js";import{_ as G}from"./_plugin-vue_export-helper-c27b6911.js";const y=u=>(H("data-v-0eaa6a29"),u=u(),O(),u),J={class:"upload-box"},L=["src"],Q=y(()=>t("span",null,"编辑",-1)),x=y(()=>t("span",null,"查看",-1)),ee=y(()=>t("span",null,"删除",-1)),ae={key:1,class:"upload-empty"},oe={class:"el-upload__tip"},se=I({name:"AUploadImg"}),le=I({...se,props:{modelValue:{default:""},api:{type:Function,default:void 0},drag:{type:Boolean,default:!0},disabled:{type:Boolean,default:!1},fileSize:{default:5},fileType:{default:()=>["image/jpeg","image/png","image/gif"]},height:{default:"150px"},width:{default:"150px"},borderRadius:{default:"8px"}},emits:["update:modelValue"],setup(u,{emit:h}){const p=u;q(e=>({"759188e9":e.width,"22d09a64":e.height,"5cf4635b":e.borderRadius}));const b=k("id-"+M()),g=k(!1),d=V(W,void 0),m=V(X,void 0),_=K(()=>p.disabled||(d==null?void 0:d.disabled)),S=async e=>{let a=new FormData;a.append("file",e.file);try{const s=p.api??Y,{data:n}=await s(a);h("update:modelValue",n.url),m!=null&&m.prop&&(d==null||d.validateField([m.prop]))}catch(s){e.onError(s)}},C=()=>{h("update:modelValue","")},E=()=>{const e=document.querySelector(`#${b.value} .el-upload__input`);e&&e.dispatchEvent(new MouseEvent("click"))},z=e=>{const a=e.size/1024/1024<p.fileSize,s=p.fileType.includes(e.type);return s||f({title:"温馨提示",message:"上传图片不符合所需的格式！",type:"warning"}),a||setTimeout(()=>{f({title:"温馨提示",message:`上传图片大小不能超过 ${p.fileSize}M！`,type:"warning"})},0),s&&a},B=()=>{f({title:"温馨提示",message:"图片上传成功！",type:"success"})},U=()=>{f({title:"温馨提示",message:"图片上传失败，请您重新上传！",type:"error"})};return(e,a)=>{const s=l("Edit"),n=l("el-icon"),$=l("ZoomIn"),D=l("Delete"),T=l("Plus"),F=l("el-upload"),N=l("el-image-viewer");return i(),c("div",J,[o(F,{id:b.value,action:"#",class:Z(["upload",_.value?"disabled":"",e.drag?"no-border":""]),multiple:!1,disabled:_.value,"show-file-list":!1,"http-request":S,"before-upload":z,"on-success":B,"on-error":U,drag:e.drag,accept:e.fileType.join(",")},{default:r(()=>[e.modelValue?(i(),c(P,{key:0},[t("img",{src:e.modelValue,class:"upload-image"},null,8,L),t("div",{class:"upload-handle",onClick:a[1]||(a[1]=R(()=>{},["stop"]))},[_.value?v("",!0):(i(),c("div",{key:0,class:"handle-icon",onClick:E},[o(n,null,{default:r(()=>[o(s)]),_:1}),Q])),t("div",{class:"handle-icon",onClick:a[0]||(a[0]=j=>g.value=!0)},[o(n,null,{default:r(()=>[o($)]),_:1}),x]),_.value?v("",!0):(i(),c("div",{key:1,class:"handle-icon",onClick:C},[o(n,null,{default:r(()=>[o(D)]),_:1}),ee]))])],64)):(i(),c("div",ae,[w(e.$slots,"empty",{},()=>[o(n,null,{default:r(()=>[o(T)]),_:1})],!0)]))]),_:3},8,["id","class","disabled","drag","accept"]),t("div",oe,[w(e.$slots,"tip",{},void 0,!0)]),g.value?(i(),A(N,{key:0,"url-list":[e.modelValue],onClose:a[2]||(a[2]=j=>g.value=!1)},null,8,["url-list"])):v("",!0)])}}});const ie=G(le,[["__scopeId","data-v-0eaa6a29"]]);export{ie as default};
