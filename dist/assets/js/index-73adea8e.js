import{U as r,d as h,r as x,a as i,o as O,e as k,f as a,i as s,g as S,y as g,n as y,t as D,V as I,W as F}from"./index-9844670a.js";import{_ as R}from"./_plugin-vue_export-helper-c27b6911.js";const j=async(d,m,u={},b=!0,c=".xlsx")=>{b&&r({title:"温馨提示",message:"如果数据庞大会导致下载缓慢哦，请您耐心等待！",type:"info",duration:3e3});try{const e=await d(u),_=new Blob([e]);if("msSaveOrOpenBlob"in navigator)return window.navigator.msSaveOrOpenBlob(_,m+c);const f=window.URL.createObjectURL(_),n=document.createElement("a");n.style.display="none",n.download=`${m}${c}`,n.href=f,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(f)}catch{}},A=d=>(I("data-v-2e1dddba"),d=d(),F(),d),N=A(()=>y("div",{class:"el-upload__text"},[S("将文件拖到此处，或"),y("em",null,"点击上传")],-1)),M={class:"el-upload__tip"},q=h({name:"ImportExcel"}),P=h({...q,setup(d,{expose:m}){const u=x(!1),b=x(1),c=x(!1),e=x({title:"",fileSize:5,fileType:["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]}),_=l=>{e.value={...e.value,...l},c.value=!0},f=()=>{e.value.tempApi&&j(e.value.tempApi,`${e.value.title}模板`)},n=async l=>{var p,o;let t=new FormData;t.append("file",l.file),t.append("isCover",u.value),await((o=(p=e.value).importApi)==null?void 0:o.call(p,t)),e.value.getTableList&&e.value.getTableList(),c.value=!1},U=l=>{var v;const t=(v=e.value.fileType)==null?void 0:v.includes(l.type),p=e.value.fileSize??5,o=l.size/1024/1024<p;return t||r({title:"温馨提示",message:"上传文件只能是 xls / xlsx 格式！",type:"warning"}),o||setTimeout(()=>{r({title:"温馨提示",message:`上传文件大小不能超过 ${e.value.fileSize}MB！`,type:"warning"})},0),t&&o},V=()=>{r({title:"温馨提示",message:"最多只能上传一个文件！",type:"warning"})},C=()=>{r({title:"温馨提示",message:`批量添加${e.value.title}失败，请您重新上传！`,type:"error"})},$=()=>{r({title:"温馨提示",message:`批量添加${e.value.title}成功！`,type:"success"})};return m({acceptParams:_}),(l,t)=>{const p=i("el-button"),o=i("el-form-item"),v=i("upload-filled"),E=i("el-icon"),z=i("el-upload"),B=i("el-switch"),L=i("el-form"),T=i("el-dialog");return O(),k(T,{modelValue:c.value,"onUpdate:modelValue":t[1]||(t[1]=w=>c.value=w),title:`批量添加${e.value.title}`,"destroy-on-close":!0,width:"580px",draggable:""},{default:a(()=>[s(L,{class:"drawer-multiColumn-form","label-width":"100px"},{default:a(()=>[s(o,{label:"模板下载 :"},{default:a(()=>[s(p,{type:"primary",icon:"Download",onClick:f},{default:a(()=>[S("点击下载")]),_:1})]),_:1}),s(o,{label:"文件上传 :"},{default:a(()=>[s(z,{action:"#",class:"upload",drag:!0,limit:b.value,multiple:!0,"show-file-list":!0,"http-request":n,"before-upload":U,"on-exceed":V,"on-success":$,"on-error":C,accept:e.value.fileType.join(",")},{tip:a(()=>[g(l.$slots,"tip",{},()=>[y("div",M,"请上传 .xls , .xlsx 标准格式文件，文件最大为 "+D(e.value.fileSize)+"M",1)],!0)]),default:a(()=>[g(l.$slots,"empty",{},()=>[s(E,{class:"el-icon--upload"},{default:a(()=>[s(v)]),_:1}),N],!0)]),_:3},8,["limit","accept"])]),_:3}),s(o,{label:"数据覆盖 :"},{default:a(()=>[s(B,{modelValue:u.value,"onUpdate:modelValue":t[0]||(t[0]=w=>u.value=w)},null,8,["modelValue"])]),_:1})]),_:3})]),_:3},8,["modelValue","title"])}}});const H=R(P,[["__scopeId","data-v-2e1dddba"]]);export{H as default};
