import{d as C,c as v,k as j,r as S,o as f,e as g,$ as U,f as m,n as B,t as F,b as w,j as G,F as M,y as K,m as E,N as A,a5 as D,s as $,a as _,i,g as V,h as R}from"./index-9844670a.js";const L=C({name:"SearchFormItem"}),O=C({...L,props:{column:{},searchParam:{}},setup(P){const c=P,d=v(()=>{var e,a,o;return{label:((e=c.column.fieldNames)==null?void 0:e.label)??"label",value:((a=c.column.fieldNames)==null?void 0:a.value)??"value",children:((o=c.column.fieldNames)==null?void 0:o.children)??"children"}}),h=j("enumMap",S(new Map)),b=v(()=>{var a;let e=h.value.get(c.column.prop);return e?(((a=c.column.search)==null?void 0:a.el)==="select-v2"&&c.column.fieldNames&&(e=e.map(o=>({...o,label:o[d.value.label],value:o[d.value.value]}))),e):[]}),k=v(()=>{var n,t;const e=d.value.label,a=d.value.value,o=d.value.children,s=(n=c.column.search)==null?void 0:n.el;let r=((t=c.column.search)==null?void 0:t.props)??{};return s==="tree-select"&&(r={...r,props:{...r.props,label:e,children:o},nodeKey:a}),s==="cascader"&&(r={...r,props:{...r.props,label:e,value:a,children:o}}),r}),N=v(()=>{var o,s,r,n;const e=c.column.search;return["datetimerange","daterange","monthrange"].includes((o=e==null?void 0:e.props)==null?void 0:o.type)||(s=e==null?void 0:e.props)!=null&&s.isRange?{rangeSeparator:"至",startPlaceholder:"开始时间",endPlaceholder:"结束时间"}:{placeholder:((r=e==null?void 0:e.props)==null?void 0:r.placeholder)??((n=e==null?void 0:e.el)!=null&&n.includes("input")?"请输入":"请选择")}}),l=v(()=>{var a;const e=c.column.search;return((a=e==null?void 0:e.props)==null?void 0:a.clearable)??((e==null?void 0:e.defaultValue)==null||(e==null?void 0:e.defaultValue)==null)});return(e,a)=>{var o,s,r,n,t,u;return f(),g($(((o=e.column.search)==null?void 0:o.render)??`el-${(s=e.column.search)==null?void 0:s.el}`),E({modelValue:e.searchParam[((r=e.column.search)==null?void 0:r.key)??A(D)(e.column.prop)],"onUpdate:modelValue":a[0]||(a[0]=p=>{var y;return e.searchParam[((y=e.column.search)==null?void 0:y.key)??A(D)(e.column.prop)]=p}),modelModifiers:{trim:!0}},{...k.value,...N.value,searchParam:e.searchParam,clearable:l.value},{data:((n=e.column.search)==null?void 0:n.el)==="tree-select"?b.value:[],options:["cascader","select-v2"].includes((t=e.column.search)==null?void 0:t.el)?b.value:[]}),U({default:m(()=>{var p;return[((p=e.column.search)==null?void 0:p.el)==="select"?(f(!0),w(M,{key:0},G(b.value,(y,I)=>(f(),g($("el-option"),{key:I,label:y[d.value.label],value:y[d.value.value]},null,8,["label","value"]))),128)):K(e.$slots,"default",{key:1})]}),_:2},[((u=e.column.search)==null?void 0:u.el)==="cascader"?{name:"default",fn:m(({data:p})=>[B("span",null,F(p[d.value.label]),1)]),key:"0"}:void 0]),1040,["modelValue","data","options"])}}}),T={key:0,class:"card table-search"},q={class:"operation"},z=C({name:"SearchForm"}),J=C({...z,props:{columns:{default:()=>[]},searchParam:{default:()=>({})},searchCol:{},search:{},reset:{}},setup(P){const c=P,d=l=>{var e,a,o,s,r,n,t;return{span:(e=l.search)==null?void 0:e.span,offset:((a=l.search)==null?void 0:a.offset)??0,xs:(o=l.search)==null?void 0:o.xs,sm:(s=l.search)==null?void 0:s.sm,md:(r=l.search)==null?void 0:r.md,lg:(n=l.search)==null?void 0:n.lg,xl:(t=l.search)==null?void 0:t.xl}},h=S(!0),b=S(),k=v(()=>{var l;return(l=b.value)==null?void 0:l.breakPoint}),N=v(()=>{let l=!1;return c.columns.reduce((e,a)=>{var o,s,r,n,t,u;return e+=(((s=(o=a.search)==null?void 0:o[k.value])==null?void 0:s.span)??((r=a.search)==null?void 0:r.span)??1)+(((t=(n=a.search)==null?void 0:n[k.value])==null?void 0:t.offset)??((u=a.search)==null?void 0:u.offset)??0),typeof c.searchCol!="number"?e>=c.searchCol[k.value]&&(l=!0):e>=c.searchCol&&(l=!0),e},0),l});return(l,e)=>{const a=_("el-form-item"),o=_("AGridItem"),s=_("el-button"),r=_("el-icon"),n=_("AGrid"),t=_("el-form");return l.columns.length?(f(),w("div",T,[i(t,{ref:"formRef",model:l.searchParam},{default:m(()=>[i(n,{ref_key:"gridRef",ref:b,collapsed:h.value,gap:[20,0],cols:l.searchCol},{default:m(()=>[(f(!0),w(M,null,G(l.columns,(u,p)=>(f(),g(o,E({key:u.prop},d(u),{index:p}),{default:m(()=>[i(a,{label:`${u.label} :`},{default:m(()=>[i(O,{column:u,"search-param":l.searchParam},null,8,["column","search-param"])]),_:2},1032,["label"])]),_:2},1040,["index"]))),128)),i(o,{suffix:""},{default:m(()=>[B("div",q,[i(s,{type:"primary",icon:"Search",onClick:l.search},{default:m(()=>[V("搜索")]),_:1},8,["onClick"]),i(s,{icon:"Delete",onClick:l.reset},{default:m(()=>[V("重置")]),_:1},8,["onClick"]),N.value?(f(),g(s,{key:0,type:"primary",link:"",class:"search-isOpen",onClick:e[0]||(e[0]=u=>h.value=!h.value)},{default:m(()=>[V(F(h.value?"展开":"合并")+" ",1),i(r,{class:"el-icon--right"},{default:m(()=>[(f(),g($(h.value?"ArrowDown":"ArrowUp")))]),_:1})]),_:1})):R("",!0)])]),_:1})]),_:1},8,["collapsed","cols"])]),_:1},8,["model"])])):R("",!0)}}});export{J as default};
